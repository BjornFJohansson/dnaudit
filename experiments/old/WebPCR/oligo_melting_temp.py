import math


def basictm(p):
    '''
    Tm = (wA+xT)*2 + (yG+zC)*4 assumed 50mM monovalent cations
    w = number of A
    x = number of T
    y = number of G
    z = number of C in primer
    '''
    p = str(p).lower()
    return (p.count("a") + p.count("t"))*2 + (p.count("g") + p.count("c"))*4

# http://www.promega.com/techserv/tools/biomath/calc11.htm#melt_results

def tmstaluc98(primer,dnac=50,saltc=50):
    '''
    SantaLucia 1998:
           dH    dS
    AA/TT  7.9   22.2
    AT/TA  7.2   20.4
    TA/AT  7.2   21.3
    CA/GT  8.5   22.7
    GT/CA  8.4   22.4
    CT/GA  7.8   21.0
    GA/CT  8.2   22.2
    CG/GC  10.6  27.2
    GC/CG  9.8   24.4
    GG/CC  8.0   19.9
    '''

    nntermsl={  "AA": (7.9  , 22.2),
                "TT": (7.9  , 22.2),
                "AT": (7.2  , 20.4),
                "TA": (7.2  , 21.3),
                "CA": (8.5  , 22.7),
                "TG": (8.5  , 22.7),
                "GT": (8.4  , 22.4),
                "AC": (8.4  , 22.4),
                "CT": (7.8  , 21.0),
                "AG": (7.8  , 21.0),
                "GA": (8.2  , 22.2),
                "TC": (8.2  , 22.2),
                "CG": (10.6 , 27.2),
                "GC": (9.8  , 24.4),
                "GG": (8    , 19.9),
                "CC": (8    , 19.9),
                "A" : (0    , 0   ),
                "C" : (0    , 0   ),
                "G" : (0    , 0   ),
                "T" : (0    , 0   )  }

    helixinit = {   "G": (-0.1 ,2.8),
                    "C": (-0.1 ,2.8),
                    "A": (-2.3, -4.1),
                    "T": (-2.3, -4.1) }

    dH, dS = helixinit[primer[0]]
    H ,  S = helixinit[primer[-1]]
    dH = dH+H
    dS = dS+S

    for p in range(len(primer)):
        dn = primer[p:p+2]
        H,S = nntermsl[dn]
        dH+=H
        dS+=S
    R = 1.987 # universal gas constant in Cal/degrees C*Mol
    k = (dnac/4.0)*1e-9
    dS = dS-0.368*(len(primer)-1)*math.log(saltc/1e3)
    tm = ((1000* (-dH))/(-dS+(R * (math.log(k)))))-273.15
    return tm

def tmbreslauer86(primer,dnac=500.0,saltc=50.0,thermodynamics=False):
    '''
    Breslauer 1986, table 2:
    AA/TT  9.1   ,24.0   ,1.9
    AT/TA  8.6   ,23.9   ,1.5
    TA/AT  6.0   ,16.9   ,0.9
    CA/GT  5.8   ,12.9   ,1.9
    GT/CA  6.5   ,17.3   ,1.3
    CT/GA  7.8   ,20.8   ,1.6
    GA/CT  5.6   ,13.5   ,1.6
    CG/GC  11.9  ,27.8   ,3.6
    GC/CG  11.1  ,26.7   ,3.1
    GG/CC  11.0  ,26.6   ,3.1
    '''
    ''' same data from Primer3 source code
    AA 240
    TT 240
    AT 239
    TA 169
    CA 129
    TG 129
    GT 173
    AC 173
    CT 208
    AG 208
    GA 135
    TC 135
    CG 278
    GC 267
    GG 266
    CC 266
    '''

    nntermbr={  "AA": (9.1   ,24.0   ,1.9),
                "TT": (9.1   ,24.0   ,1.9),
                "AT": (8.6   ,23.9   ,1.5),
                "TA": (6.0   ,16.9   ,0.9),
                "CA": (5.8   ,12.9   ,1.9),
                "TG": (5.8   ,12.9   ,1.9),
                "GT": (6.5   ,17.3   ,1.3),
                "AC": (6.5   ,17.3   ,1.3),
                "CT": (7.8   ,20.8   ,1.6),
                "AG": (7.8   ,20.8   ,1.6),
                "GA": (5.6   ,13.5   ,1.6),
                "TC": (5.6   ,13.5   ,1.6),
                "CG": (11.9  ,27.8   ,3.6),
                "GC": (11.1  ,26.7   ,3.1),
                "GG": (11.0  ,26.6   ,3.1),
                "CC": (11.0  ,26.6   ,3.1),
                "A" : (0    , 0   ,0),
                "C" : (0    , 0   ,0),
                "G" : (0    , 0   ,0),
                "T" : (0    , 0   ,0),     }
    dH=3.4
    dS=12.4
    dG=0
    for p in range(len(primer)):
        dn = primer[p:p+2]
        H,S,G = nntermbr[dn]
        dG+=G
        dH+=H
        dS+=S

    R = 1.9872          # universal gas constant in Cal/degrees C*Mol
    k = dnac*1E-9/2.0
    dH = dH - 5
    dS = dS-0.368*(len(primer)-1)*math.log(saltc/1E3) # SantaLucia salt correction formula
    tm = 1000 * -dH /(-dS + R * math.log(k) )  - 273.15 # degrees Celsius

    if thermodynamics:
        return tm,dH,dS
    else:
        return tm


def tmbresluc(primer,primerc=500.0,saltc=50.0,thermodynamics=False):

    import collections

    dHBr = collections.defaultdict(dict)
    dSBr = collections.defaultdict(dict)

    dHBr[0][0] = -9100
    dSBr[0][0] = -24
    dHBr[0][1] = -7633.3000000000002
    dSBr[0][1] = -20.699999999999999
    dHBr[0][2] = -6500
    dSBr[0][2] = -17.300000000000001
    dHBr[0][3] = -8500
    dSBr[0][3] = -22.899999999999999
    dHBr[0][6] = -7800
    dSBr[0][6] = -20.800000000000001
    dHBr[0][7] = -8066.6999999999998
    dSBr[0][7] = -21.699999999999999
    dHBr[0][10] = -8200
    dSBr[0][10] = -22.399999999999999
    dHBr[0][12] = -7800
    dSBr[0][12] = -20.699999999999999
    dHBr[0][13] = -8000
    dSBr[0][13] = -21.5
    dHBr[0][17] = -8450
    dSBr[0][17] = -22.399999999999999
    dHBr[0][18] = -7150
    dSBr[0][18] = -19.100000000000001
    dHBr[0][19] = -8600
    dSBr[0][19] = -23.899999999999999
    dHBr[0][21] = -7800
    dSBr[0][21] = -20.699999999999999
    dHBr[0][22] = -8850
    dSBr[0][22] = -24
    dHBr[0][23] = -8000
    dSBr[0][23] = -21.5
    dHBr[0][24] = -7550
    dSBr[0][24] = -20.600000000000001
    dHBr[1][0] = -5800
    dSBr[1][0] = -14.4
    dHBr[1][1] = -8866.7000000000007
    dSBr[1][1] = -21.800000000000001
    dHBr[1][2] = -9233.2999999999993
    dSBr[1][2] = -22.300000000000001
    dHBr[1][3] = -7722.1999999999998
    dSBr[1][3] = -19.199999999999999
    dHBr[1][6] = -9566.7000000000007
    dSBr[1][6] = -22.399999999999999
    dHBr[1][7] = -7611.1000000000004
    dSBr[1][7] = -19.100000000000001
    dHBr[1][10] = -8683.2999999999993
    dSBr[1][10] = -21.600000000000001
    dHBr[1][12] = -7516.6999999999998
    dSBr[1][12] = -18.399999999999999
    dHBr[1][13] = -8100
    dSBr[1][13] = -20
    dHBr[1][17] = -7683.3000000000002
    dSBr[1][17] = -18.399999999999999
    dHBr[1][18] = -9400
    dSBr[1][18] = -22.399999999999999
    dHBr[1][19] = -7800
    dSBr[1][19] = -20.699999999999999
    dHBr[1][21] = -8200
    dSBr[1][21] = -19.699999999999999
    dHBr[1][22] = -6800
    dSBr[1][22] = -17.600000000000001
    dHBr[1][23] = -8100
    dSBr[1][23] = -20
    dHBr[1][24] = -8516.7000000000007
    dSBr[1][24] = -21.5
    dHBr[2][0] = -5800
    dSBr[2][0] = -12.9
    dHBr[2][1] = -10233.299999999999
    dSBr[2][1] = -25.100000000000001
    dHBr[2][2] = -11000
    dSBr[2][2] = -26.600000000000001
    dHBr[2][3] = -8500
    dSBr[2][3] = -20.5
    dHBr[2][6] = -11900
    dSBr[2][6] = -27.800000000000001
    dHBr[2][7] = -8200
    dSBr[2][7] = -20.100000000000001
    dHBr[2][10] = -9850
    dSBr[2][10] = -24.300000000000001
    dHBr[2][12] = -8400
    dSBr[2][12] = -19.800000000000001
    dHBr[2][13] = -9125
    dSBr[2][13] = -22
    dHBr[2][17] = -8850
    dSBr[2][17] = -20.399999999999999
    dHBr[2][18] = -11450
    dSBr[2][18] = -27.199999999999999
    dHBr[2][19] = -7800
    dSBr[2][19] = -20.800000000000001
    dHBr[2][21] = -9566.7000000000007
    dSBr[2][21] = -22.399999999999999
    dHBr[2][22] = -6800
    dSBr[2][22] = -16.899999999999999
    dHBr[2][23] = -9125
    dSBr[2][23] = -22
    dHBr[2][24] = -9400
    dSBr[2][24] = -23.699999999999999
    dHBr[3][0] = -6900
    dSBr[3][0] = -18.100000000000001
    dHBr[3][1] = -8000
    dSBr[3][1] = -20.300000000000001
    dHBr[3][2] = -7733.3000000000002
    dSBr[3][2] = -19.199999999999999
    dHBr[3][3] = -7722.1999999999998
    dSBr[3][3] = -20
    dHBr[3][6] = -8200
    dSBr[3][6] = -20.100000000000001
    dHBr[3][7] = -7566.6999999999998
    dSBr[3][7] = -19.699999999999999
    dHBr[3][10] = -8133.3000000000002
    dSBr[3][10] = -20.899999999999999
    dHBr[3][12] = -7316.6999999999998
    dSBr[3][12] = -18.699999999999999
    dHBr[3][13] = -7725
    dSBr[3][13] = -19.800000000000001
    dHBr[3][17] = -7550
    dSBr[3][17] = -19.100000000000001
    dHBr[3][18] = -7966.6999999999998
    dSBr[3][18] = -19.600000000000001
    dHBr[3][19] = -8066.6999999999998
    dSBr[3][19] = -21.699999999999999
    dHBr[3][21] = -7611.1000000000004
    dSBr[3][21] = -19.100000000000001
    dHBr[3][22] = -7483.3000000000002
    dSBr[3][22] = -19.899999999999999
    dHBr[3][23] = -7725
    dSBr[3][23] = -19.800000000000001
    dHBr[3][24] = -7900
    dSBr[3][24] = -20.5
    dHBr[6][0] = -5600
    dSBr[6][0] = -13.5
    dHBr[6][1] = -9533.2999999999993
    dSBr[6][1] = -23.5
    dHBr[6][2] = -11100
    dSBr[6][2] = -26.699999999999999
    dHBr[6][3] = -7700
    dSBr[6][3] = -19.100000000000001
    dHBr[6][6] = -11000
    dSBr[6][6] = -26.600000000000001
    dHBr[6][7] = -7733.3000000000002
    dSBr[6][7] = -19.199999999999999
    dHBr[6][10] = -8750
    dSBr[6][10] = -22
    dHBr[6][12] = -8350
    dSBr[6][12] = -20.100000000000001
    dHBr[6][13] = -8550
    dSBr[6][13] = -21
    dHBr[6][17] = -8300
    dSBr[6][17] = -20.100000000000001
    dHBr[6][18] = -11050
    dSBr[6][18] = -26.699999999999999
    dHBr[6][19] = -6500
    dSBr[6][19] = -17.300000000000001
    dHBr[6][21] = -9233.2999999999993
    dSBr[6][21] = -22.300000000000001
    dHBr[6][22] = -6050
    dSBr[6][22] = -15.4
    dHBr[6][23] = -8550
    dSBr[6][23] = -21
    dHBr[6][24] = -8800
    dSBr[6][24] = -22
    dHBr[7][0] = -6966.6999999999998
    dSBr[7][0] = -17.899999999999999
    dHBr[7][1] = -8233.2999999999993
    dSBr[7][1] = -20.800000000000001
    dHBr[7][2] = -7700
    dSBr[7][2] = -19.100000000000001
    dHBr[7][3] = -7988.8999999999996
    dSBr[7][3] = -20.399999999999999
    dHBr[7][6] = -8500
    dSBr[7][6] = -20.5
    dHBr[7][7] = -7722.1999999999998
    dSBr[7][7] = -20
    dHBr[7][10] = -8500
    dSBr[7][10] = -21.699999999999999
    dHBr[7][12] = -7333.3000000000002
    dSBr[7][12] = -18.5
    dHBr[7][13] = -7916.6999999999998
    dSBr[7][13] = -20.100000000000001
    dHBr[7][17] = -7733.3000000000002
    dSBr[7][17] = -19.199999999999999
    dHBr[7][18] = -8100
    dSBr[7][18] = -19.800000000000001
    dHBr[7][19] = -8500
    dSBr[7][19] = -22.899999999999999
    dHBr[7][21] = -7722.1999999999998
    dSBr[7][21] = -19.199999999999999
    dHBr[7][22] = -7733.3000000000002
    dSBr[7][22] = -20.399999999999999
    dHBr[7][23] = -7916.6999999999998
    dSBr[7][23] = -20.100000000000001
    dHBr[7][24] = -8100
    dSBr[7][24] = -21
    dHBr[10][0] = -5800
    dSBr[10][0] = -15.199999999999999
    dHBr[10][1] = -8183.3000000000002
    dSBr[10][1] = -20.199999999999999
    dHBr[10][2] = -8350
    dSBr[10][2] = -20.100000000000001
    dHBr[10][3] = -7333.3000000000002
    dSBr[10][3] = -18.5
    dHBr[10][6] = -8400
    dSBr[10][6] = -19.800000000000001
    dHBr[10][7] = -7316.6999999999998
    dSBr[10][7] = -18.699999999999999
    dHBr[10][10] = -8100
    dSBr[10][10] = -20.199999999999999
    dHBr[10][12] = -7075
    dSBr[10][12] = -17.699999999999999
    dHBr[10][13] = -7587.5
    dSBr[10][13] = -18.899999999999999
    dHBr[10][17] = -7100
    dSBr[10][17] = -17.5
    dHBr[10][18] = -8375
    dSBr[10][18] = -19.899999999999999
    dHBr[10][19] = -7800
    dSBr[10][19] = -20.699999999999999
    dHBr[10][21] = -7516.6999999999998
    dSBr[10][21] = -18.399999999999999
    dHBr[10][22] = -6800
    dSBr[10][22] = -17.899999999999999
    dHBr[10][23] = -7587.5
    dSBr[10][23] = -18.899999999999999
    dHBr[10][24] = -8075
    dSBr[10][24] = -20.399999999999999
    dHBr[12][0] = -7450
    dSBr[12][0] = -18.5
    dHBr[12][1] = -8933.2999999999993
    dSBr[12][1] = -22.899999999999999
    dHBr[12][2] = -8750
    dSBr[12][2] = -22
    dHBr[12][3] = -8500
    dSBr[12][3] = -21.699999999999999
    dHBr[12][6] = -9850
    dSBr[12][6] = -24.300000000000001
    dHBr[12][7] = -8133.3000000000002
    dSBr[12][7] = -20.899999999999999
    dHBr[12][10] = -9025
    dSBr[12][10] = -23.300000000000001
    dHBr[12][12] = -8100
    dSBr[12][12] = -20.199999999999999
    dHBr[12][13] = -8562.5
    dSBr[12][13] = -21.800000000000001
    dHBr[12][17] = -8650
    dSBr[12][17] = -21.399999999999999
    dHBr[12][18] = -9300
    dSBr[12][18] = -23.100000000000001
    dHBr[12][19] = -8200
    dSBr[12][19] = -22.399999999999999
    dHBr[12][21] = -8683.2999999999993
    dSBr[12][21] = -21.600000000000001
    dHBr[12][22] = -7825
    dSBr[12][22] = -20.399999999999999
    dHBr[12][23] = -8562.5
    dSBr[12][23] = -21.800000000000001
    dHBr[12][24] = -8475
    dSBr[12][24] = -22.199999999999999
    dHBr[13][0] = -6625
    dSBr[13][0] = -16.800000000000001
    dHBr[13][1] = -8558.2999999999993
    dSBr[13][1] = -21.5
    dHBr[13][2] = -8550
    dSBr[13][2] = -21
    dHBr[13][3] = -7916.6999999999998
    dSBr[13][3] = -20.100000000000001
    dHBr[13][6] = -9125
    dSBr[13][6] = -22
    dHBr[13][7] = -7725
    dSBr[13][7] = -19.800000000000001
    dHBr[13][10] = -8562.5
    dSBr[13][10] = -21.800000000000001
    dHBr[13][12] = -7587.5
    dSBr[13][12] = -18.899999999999999
    dHBr[13][13] = -8075
    dSBr[13][13] = -20.300000000000001
    dHBr[13][17] = -7875
    dSBr[13][17] = -19.399999999999999
    dHBr[13][18] = -8837.5
    dSBr[13][18] = -21.5
    dHBr[13][19] = -8000
    dSBr[13][19] = -21.5
    dHBr[13][21] = -8100
    dSBr[13][21] = -20
    dHBr[13][22] = -7312.5
    dSBr[13][22] = -19.199999999999999
    dHBr[13][23] = -8075
    dSBr[13][23] = -20.300000000000001
    dHBr[13][24] = -8275
    dSBr[13][24] = -21.300000000000001
    dHBr[17][0] = -7350
    dSBr[17][0] = -18.800000000000001
    dHBr[17][1] = -8583.2999999999993
    dSBr[17][1] = -22.100000000000001
    dHBr[17][2] = -8800
    dSBr[17][2] = -22
    dHBr[17][3] = -8100
    dSBr[17][3] = -21
    dHBr[17][6] = -9400
    dSBr[17][6] = -23.699999999999999
    dHBr[17][7] = -7900
    dSBr[17][7] = -20.5
    dHBr[17][10] = -8475
    dSBr[17][10] = -22.199999999999999
    dHBr[17][12] = -8075
    dSBr[17][12] = -20.399999999999999
    dHBr[17][13] = -8275
    dSBr[17][13] = -21.300000000000001
    dHBr[17][17] = -8375
    dSBr[17][17] = -21.199999999999999
    dHBr[17][18] = -9100
    dSBr[17][18] = -22.899999999999999
    dHBr[17][19] = -7550
    dSBr[17][19] = -20.600000000000001
    dHBr[17][21] = -8516.7000000000007
    dSBr[17][21] = -21.5
    dHBr[17][22] = -7450
    dSBr[17][22] = -19.699999999999999
    dHBr[17][23] = -8275
    dSBr[17][23] = -21.300000000000001
    dHBr[17][24] = -8175
    dSBr[17][24] = -21.300000000000001
    dHBr[18][0] = -5700
    dSBr[18][0] = -13.199999999999999
    dHBr[18][1] = -9883.2999999999993
    dSBr[18][1] = -24.300000000000001
    dHBr[18][2] = -11050
    dSBr[18][2] = -26.699999999999999
    dHBr[18][3] = -8100
    dSBr[18][3] = -19.800000000000001
    dHBr[18][6] = -11450
    dSBr[18][6] = -27.199999999999999
    dHBr[18][7] = -7966.6999999999998
    dSBr[18][7] = -19.600000000000001
    dHBr[18][10] = -9300
    dSBr[18][10] = -23.100000000000001
    dHBr[18][12] = -8375
    dSBr[18][12] = -19.899999999999999
    dHBr[18][13] = -8837.5
    dSBr[18][13] = -21.5
    dHBr[18][17] = -8575
    dSBr[18][17] = -20.199999999999999
    dHBr[18][18] = -11250
    dSBr[18][18] = -26.899999999999999
    dHBr[18][19] = -7150
    dSBr[18][19] = -19.100000000000001
    dHBr[18][21] = -9400
    dSBr[18][21] = -22.399999999999999
    dHBr[18][22] = -6425
    dSBr[18][22] = -16.100000000000001
    dHBr[18][23] = -8837.5
    dSBr[18][23] = -21.5
    dHBr[18][24] = -9100
    dSBr[18][24] = -22.899999999999999
    dHBr[19][0] = -6000
    dSBr[19][0] = -16.899999999999999
    dHBr[19][1] = -6833.3000000000002
    dSBr[19][1] = -16.800000000000001
    dHBr[19][2] = -5600
    dSBr[19][2] = -13.5
    dHBr[19][3] = -6966.6999999999998
    dSBr[19][3] = -17.899999999999999
    dHBr[19][6] = -5800
    dSBr[19][6] = -12.9
    dHBr[19][7] = -6900
    dSBr[19][7] = -18.100000000000001
    dHBr[19][10] = -7450
    dSBr[19][10] = -18.5
    dHBr[19][12] = -5800
    dSBr[19][12] = -15.199999999999999
    dHBr[19][13] = -6625
    dSBr[19][13] = -16.800000000000001
    dHBr[19][17] = -5900
    dSBr[19][17] = -14.9
    dHBr[19][18] = -5700
    dSBr[19][18] = -13.199999999999999
    dHBr[19][19] = -9100
    dSBr[19][19] = -24
    dHBr[19][21] = -5800
    dSBr[19][21] = -14.4
    dHBr[19][22] = -7550
    dSBr[19][22] = -20.5
    dHBr[19][23] = -6625
    dSBr[19][23] = -16.800000000000001
    dHBr[19][24] = -7350
    dSBr[19][24] = -18.800000000000001
    dHBr[21][0] = -6833.3000000000002
    dSBr[21][0] = -16.800000000000001
    dHBr[21][1] = -9133.2999999999993
    dSBr[21][1] = -23.100000000000001
    dHBr[21][2] = -9533.2999999999993
    dSBr[21][2] = -23.5
    dHBr[21][3] = -8233.2999999999993
    dSBr[21][3] = -20.800000000000001
    dHBr[21][6] = -10233.299999999999
    dSBr[21][6] = -25.100000000000001
    dHBr[21][7] = -8000
    dSBr[21][7] = -20.300000000000001
    dHBr[21][10] = -8933.2999999999993
    dSBr[21][10] = -22.899999999999999
    dHBr[21][12] = -8183.3000000000002
    dSBr[21][12] = -20.199999999999999
    dHBr[21][13] = -8558.2999999999993
    dSBr[21][13] = -21.5
    dHBr[21][17] = -8533.2999999999993
    dSBr[21][17] = -20.899999999999999
    dHBr[21][18] = -9883.2999999999993
    dSBr[21][18] = -24.300000000000001
    dHBr[21][19] = -7633.3000000000002
    dSBr[21][19] = -20.699999999999999
    dHBr[21][21] = -8866.7000000000007
    dSBr[21][21] = -21.800000000000001
    dHBr[21][22] = -7233.3000000000002
    dSBr[21][22] = -18.699999999999999
    dHBr[21][23] = -8558.2999999999993
    dSBr[21][23] = -21.5
    dHBr[21][24] = -8583.2999999999993
    dSBr[21][24] = -22.100000000000001
    dHBr[22][0] = -7550
    dSBr[22][0] = -20.5
    dHBr[22][1] = -7233.3000000000002
    dSBr[22][1] = -18.699999999999999
    dHBr[22][2] = -6050
    dSBr[22][2] = -15.4
    dHBr[22][3] = -7733.3000000000002
    dSBr[22][3] = -20.399999999999999
    dHBr[22][6] = -6800
    dSBr[22][6] = -16.899999999999999
    dHBr[22][7] = -7483.3000000000002
    dSBr[22][7] = -19.899999999999999
    dHBr[22][10] = -7825
    dSBr[22][10] = -20.399999999999999
    dHBr[22][12] = -6800
    dSBr[22][12] = -17.899999999999999
    dHBr[22][13] = -7312.5
    dSBr[22][13] = -19.199999999999999
    dHBr[22][17] = -7175
    dSBr[22][17] = -18.699999999999999
    dHBr[22][18] = -6425
    dSBr[22][18] = -16.100000000000001
    dHBr[22][19] = -8850
    dSBr[22][19] = -24
    dHBr[22][21] = -6800
    dSBr[22][21] = -17.600000000000001
    dHBr[22][22] = -8200
    dSBr[22][22] = -22.199999999999999
    dHBr[22][23] = -7312.5
    dSBr[22][23] = -19.199999999999999
    dHBr[22][24] = -7450
    dSBr[22][24] = -19.699999999999999
    dHBr[23][0] = -6625
    dSBr[23][0] = -16.800000000000001
    dHBr[23][1] = -8558.2999999999993
    dSBr[23][1] = -21.5
    dHBr[23][2] = -8550
    dSBr[23][2] = -21
    dHBr[23][3] = -7916.6999999999998
    dSBr[23][3] = -20.100000000000001
    dHBr[23][6] = -9125
    dSBr[23][6] = -22
    dHBr[23][7] = -7725
    dSBr[23][7] = -19.800000000000001
    dHBr[23][10] = -8562.5
    dSBr[23][10] = -21.800000000000001
    dHBr[23][12] = -7587.5
    dSBr[23][12] = -18.899999999999999
    dHBr[23][13] = -8075
    dSBr[23][13] = -20.300000000000001
    dHBr[23][17] = -7875
    dSBr[23][17] = -19.399999999999999
    dHBr[23][18] = -8837.5
    dSBr[23][18] = -21.5
    dHBr[23][19] = -8000
    dSBr[23][19] = -21.5
    dHBr[23][21] = -8100
    dSBr[23][21] = -20
    dHBr[23][22] = -7312.5
    dSBr[23][22] = -19.199999999999999
    dHBr[23][23] = -8075
    dSBr[23][23] = -20.300000000000001
    dHBr[23][24] = -8275
    dSBr[23][24] = -21.300000000000001
    dHBr[24][0] = -5900
    dSBr[24][0] = -14.9
    dHBr[24][1] = -8533.2999999999993
    dSBr[24][1] = -20.899999999999999
    dHBr[24][2] = -8300
    dSBr[24][2] = -20.100000000000001
    dHBr[24][3] = -7733.3000000000002
    dSBr[24][3] = -19.199999999999999
    dHBr[24][6] = -8850
    dSBr[24][6] = -20.399999999999999
    dHBr[24][7] = -7550
    dSBr[24][7] = -19.100000000000001
    dHBr[24][10] = -8650
    dSBr[24][10] = -21.399999999999999
    dHBr[24][12] = -7100
    dSBr[24][12] = -17.5
    dHBr[24][13] = -7875
    dSBr[24][13] = -19.399999999999999
    dHBr[24][17] = -7375
    dSBr[24][17] = -17.600000000000001
    dHBr[24][18] = -8575
    dSBr[24][18] = -20.199999999999999
    dHBr[24][19] = -8450
    dSBr[24][19] = -22.399999999999999
    dHBr[24][21] = -7683.3000000000002
    dSBr[24][21] = -18.399999999999999
    dHBr[24][22] = -7175
    dSBr[24][22] = -18.699999999999999
    dHBr[24][23] = -7875
    dSBr[24][23] = -19.399999999999999
    dHBr[24][24] = -8375
    dSBr[24][24] = -21.199999999999999

    saltc = saltc/1000
    pri  = primerc/10E7
    dS = -12.4
    dH = -3400

    STR = primer.lower();

    for i in range(len(STR)-1):
        n1=ord(STR[i])
        n2=ord(STR[i+1])
        dH += dHBr[n1 - 97][n2 - 97]
        dS += dSBr[n1 - 97][n2 - 97]

    tm = (dH / (1.9872 * math.log(pri / 1600) + dS) + (16.6 * math.log(saltc)) / math.log(10)) - 273.15

    if thermodynamics:
        return tm,dH,dS
    else:
        return tm

if __name__ == "__main__":

    import textwrap

    oligos_table_3='''
    GCGCGC
    CGTCGACG
    GAAGCTTC
    GGAATTCC
    GGTATACC
    GCGAATTCGC
    CAAAAAG
    CAAACAAAG
    CAAAAAAAG
    CAAATAAAG
    CAAAGAAAG
    CGCGTACGCGTACGCG'''

    for oligo in textwrap.dedent(oligos_table_3).splitlines():
        pass #print tmbreslauer86(oligo, thermodynamics = True)[3]

    oligos = '''
                CAGTCAGTACGTACGTGTACTGCCGTA
                CAGTCAGTACGTACGTGTACTGCCGTAGG
                CAGTCAGTACGTACGTGTACTGCCG
             '''

    for oligo in textwrap.dedent(oligos).splitlines():
        print oligo
        print tmbreslauer86(oligo)#, thermodynamics = True)
        print tmbresluc(oligo)    #, thermodynamics = True)
        print

     #                                  FZ     Primer3Plus
     #  CAGTCAGTACGTACGTGTACTGCCGTA     68.83  68.69
     #  CAGTCAGTACGTACGTGTACTGCCGTAGG   71.5   71.70
     #  CAGTCAGTACGTACGTGTACTGCCG       68.7   68.59


